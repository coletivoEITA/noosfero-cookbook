# encoding: utf-8
# Backup model
# Generated by Chef

Backup::Model.new <%= @name.to_sym.inspect %>, <%= @description.to_s.inspect %> do
  database PostgreSQL do |db|
    db.name = <%= @db[:name] %>
    db.host = <%= @db[:hostname] %>
    db.port = <%= @db[:port] %>
    db.username = <%= @db[:username] %>
    db.password = <%= @db[:password] %>
  end

  store_with Hg do |hg|
    hg.ip = <%= @backup[:to][:host] %>
    hg.port = <%= @backup[:to][:port] %>
    hg.username = <%= @backup[:to][:user] %>
    hg.path = <%= @backup[:to][:path] %>

  <% if @paths_in_code %>
    hg.syncer.add <%= @code_path %>
  <% elsif @user_install %>
  <% %w[ code data config log run tmp ].each do |dir| %>
    hg.syncer.add <%= instance_variable_get "@#{dir}_path" %>
  <% end %>
  <% else #TODO %>
  <% end %>
    hg.syncer.exclude '.git'
    hg.syncer.exclude '.sass-cache'
  end
end
